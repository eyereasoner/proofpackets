# ------------
# 4 Color test
# ------------
#
# See https://en.wikipedia.org/wiki/Four_color_theorem

@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix list: <http://www.w3.org/2000/10/swap/list#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#>.
@prefix var: <http://www.w3.org/2000/10/swap/var#>.
@prefix : <http://example.org/#>.

# map
:A :neighbours (:D :G :F :E).
:B :neighbours (:E :H).
:C :neighbours (:H).
:D :neighbours (:A :F :E).
:E :neighbours (:G :A :F :B :D).
:F :neighbours (:A :D :E).
:G :neighbours (:A :E).
:H :neighbours (:C :B).

# rules
_:bng_1 log:isImpliedBy _:bng_2.

_:bng_1 {
    var:MAP :color var:PLACES.
}

_:bng_2 {
    ((var:PLACE var:X) _:bng_3 var:PLACES) log:collectAllIn var:SCOPE.
    var:PLACES :places true.
    [] rdf:value true; log:callWithCut true.
}

_:bng_3 {
    var:PLACE :neighbours var:Y.
}

_:bng_4 log:isImpliedBy true.

_:bng_4 {
    () :places true.
}

_:bng_5 log:isImpliedBy _:bng_6.

_:bng_5 {
    var:PLACES :places true.
}

_:bng_6 {
    var:PLACES list:firstRest ((var:PLACE var:COLOR) var:TAIL).
    var:TAIL :places true.
    var:PLACE :neighbours var:NEIGHBOURS.
    (:red :green :blue :yellow) list:member var:COLOR.
    (1 _:bng_7 ()) log:collectAllIn var:SCOPE.
}

_:bng_7 {
    var:TAIL list:member (var:NEIGHBOUR var:COLOR).
    var:NEIGHBOURS list:member var:NEIGHBOUR.
}

# query
_:bng_8 log:query _:bng_8.

_:bng_8 {
    :map :color var:PLACES.
}
